### 创新性说明

#### 短暂连接传输的蓝牙数据交互方式

1、payload 长度的要求

蓝牙广播包的方式限制了 payload 的长度范围，使得传输数据的长度受到限制。

对于一些 Receive Only 的设备，其它设备无法读取其 payload，此时通过数据的读写来实现传输，并在内部实现了对分片传播的处理，使得最大的可传输数据长度变为 512 字节。因此需要通过建立短暂蓝牙连接的方式写入数据。

2、广播包的不安全性

广播包的时候其他的任意设备都可以收到发送出去的 payload，因此处于安全性考虑，不采用这种方式发送数据包。

3、蓝牙连接提高安全性

通过蓝牙之间建立短暂连接的方式去交互，可以确保收到 payload的设备必然安装本 Pioneer APP，此时发送数据包提高安全性。

4、多设备交互

通过短暂连接传输交互数据一次同时连接多个设备，连接效果效果稳定。

#### 抗重放攻击 MAC

在传统的 payload 的基础上添加了有效期的限制和 MAC 的认证，从而提高了系统对于重放攻击的防御能力。

1、有效期验证

在收到数据包的时候，先去检测收到时间是否在数据包有效期之内，如果在有效期之内则收下，否则丢弃数据包。

2、MAC 验证

MAC 是在 APP 下载了感染者信息，与本地保存的临时标识符去匹配。MAC 是由 payload 的四项和当天的 Matching Key 通过 HMAC-SHA256生成的。

在匹配成功的情况下，则去验证 MAC，验证通过方可说明该用户是密切接触者，则后台自动上传该用户近 14 天的 Matching Keys。否则，认为该数据包是被伪造的。